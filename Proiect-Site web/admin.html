<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Magazin de Haine</title>
	<link rel="stylesheet" href="style.css">
</head>

	<header>
		<h2>Admin</h2>
	</header>
	
	<input type="checkbox" id="toggle-menu" hidden>
	<label for="toggle-menu" class="menu-icon">&#9776; Meniu</label>
	
	<nav class="start-menu">
	<ul>
		<li><a href="index.html">Acasă</a></li>

		<li class="has-submenu">
			<input type="checkbox" id="toggle-submenu" hidden>
			<label for="toggle-submenu" class="submenu-toggle">Produse</label>
			<ul class="submenu">
				<li><a href="produse.html">Toate Produsele</a></li>
				<li><a href="femei.html">Femei</a></li>
			</ul>
		</li>

		<li><a href="contact.html">Contact</a></li>
		<li><a href="login.html">Log in</a></li>
		<li><a href="signup.html">La tine in oras?</a></li>
		<li><a href="validare.html">Sign up</a></li>
	</ul>
	</nav>
	
	
	

<id="tabelProduse">
    <tr>
        <th>Imagine</th>
        <th>Nume Produs</th>
        <th>Preț</th>
        <th>Acțiuni</th>
    </tr>
</table>
<h2>Meniu</h2>
	

<h2>Adaugă / Editează Produs</h2>

<form id="formularProduse">
    <input type="hidden" id="indexEditare"> 

    <label for="nume">Nume produs:</label>
    <input type="text" id="nume" required><br><br>

    <label for="pret">Preț:</label>
    <input type="text" id="pret" required><br><br>

    <label for="imagine">Imagine produs:</label>
    <input type="file" id="imagine" accept="image/*"><br><br>

    <button type="button" onclick="adaugaSauModificaProdus()">Adaugă Produs</button>
</form>

<script>
    let indexEditare = null; 

    function adaugaSauModificaProdus() {
        console.log("🔹 Funcția adaugaSauModificaProdus() a fost apelată."); 

        var nume = document.getElementById("nume").value;
        var pret = document.getElementById("pret").value;
        var imagineInput = document.getElementById("imagine");

        if (nume === "" || pret === "") {
            alert("Completează toate câmpurile!");
            return;
        }

        var produse = JSON.parse(localStorage.getItem("produse")) || [];

        var reader = new FileReader();

        reader.onload = function (e) {
            var imgSrc = e.target.result;

            if (indexEditare !== null) {
                console.log("✏️ Edităm produsul:", indexEditare);
                produse[indexEditare] = {
                    imagine: imgSrc,
                    nume: nume,
                    pret: pret
                };
                indexEditare = null;
                document.querySelector("button[type=button]").innerText = "Adaugă Produs";
            } else {
                console.log("➕ Adăugăm un produs nou.");
                produse.push({
                    imagine: imgSrc,
                    nume: nume,
                    pret: pret
                });
            }

            localStorage.setItem("produse", JSON.stringify(produse));
            afiseazaProduse();

            console.log("✅ Produs salvat:", produse);
            
            
            document.getElementById("nume").value = "";
            document.getElementById("pret").value = "";
            document.getElementById("imagine").value = "";
        };

        if (imagineInput.files.length > 0) {
            console.log("📷 Imagine selectată, încărcăm...");
            reader.readAsDataURL(imagineInput.files[0]);
        } else {
            console.log("⚠️ Nicio imagine selectată!");
            if (indexEditare !== null) {
                reader.onload({ target: { result: produse[indexEditare].imagine } });
            }
        }
    }

    function stergeProdus(index) {
        console.log("🗑️ Ștergem produsul:", index);
        var produse = JSON.parse(localStorage.getItem("produse")) || [];
        produse.splice(index, 1);
        localStorage.setItem("produse", JSON.stringify(produse));
        afiseazaProduse();
    }

    function editeazaProdus(index) {
        console.log("✏️ Editare produs:", index);
        var produse = JSON.parse(localStorage.getItem("produse")) || [];
        var produs = produse[index];

        document.getElementById("nume").value = produs.nume;
        document.getElementById("pret").value = produs.pret;
        indexEditare = index;

        document.querySelector("button[type=button]").innerText = "Salvează Modificările";
    }

    function afiseazaProduse() {
        console.log("📜 Afișăm lista de produse.");
        var produse = JSON.parse(localStorage.getItem("produse")) || [];
        var tabel = document.getElementById("tabelProduse");

        tabel.innerHTML = `
            <tr>
                <th>Imagine</th>
                <th>Nume Produs</th>
                <th>Preț</th>
                <th>Acțiuni</th>
            </tr>
        `;

        produse.forEach((produs, index) => {
            var rand = tabel.insertRow(-1);
            rand.innerHTML = `
                <td><img src="${produs.imagine}" width="100" height="100"></td>
                <td>${produs.nume}</td>
                <td>${produs.pret} RON</td>
                <td>
                    <button onclick="editeazaProdus(${index})">Editează</button>
                    <button onclick="stergeProdus(${index})">Șterge</button>
                </td>
            `;
        });
    }

    afiseazaProduse();
</script>
